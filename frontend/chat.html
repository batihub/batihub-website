<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Chat – baerhub</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="chat.css">
    <script>
        const savedTheme = localStorage.getItem('baerhub-theme') || 'light';
        if (savedTheme === 'dark') document.documentElement.setAttribute('data-theme', 'dark');
    </script>
</head>
<body>

<nav class="top-nav">
    <div class="nav-container">
        <a href="index.html" class="nav-logo">
            <span class="bold">baer</span><span class="light">hub</span>
        </a>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="blog.html">BeeLog</a>
            <a href="chat.html" class="active">Live Chat</a>
            <button id="theme-toggle" class="theme-toggle-btn" aria-label="Toggle Theme">
                <i class="fa-solid fa-moon"></i>
            </button>
            <a href="https://github.com/batihub" target="_blank" class="github-link">
                <i class="fa-brands fa-github"></i> GitHub
            </a>
        </div>
    </div>
</nav>

<main class="main-content">
    <div class="chat-wrapper">
        <div class="page-header text-center">
            <h1 class="site-title">Live Rooms</h1>
            <p>Connect instantly via WebSockets</p>
        </div>

        <div class="chat-container">

            <!-- ── Join / Auth Panel ─────────────────────────────────── -->
            <div id="join-panel" class="panel">

                <!-- Tab bar -->
                <div class="auth-tabs">
                    <button class="auth-tab active" data-tab="login">
                        <i class="fa-solid fa-right-to-bracket"></i> Log In
                    </button>
                    <button class="auth-tab" data-tab="register">
                        <i class="fa-solid fa-user-plus"></i> Register
                    </button>
                </div>

                <!-- Login Form -->
                <div id="login-form" class="auth-form" style="margin-top:28px">
                    <h2 style="margin:0 0 24px 0; text-align:center">Join the Room</h2>
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="username" placeholder="your_username">
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="password" placeholder="••••••••">
                    </div>
                    <button class="btn btn-primary btn-block" onclick="connectWebSocket()">
                        Enter Room <i class="fa-solid fa-arrow-right"></i>
                    </button>
                </div>

                <!-- Register Form -->
                <div id="register-form" class="auth-form" style="display:none; margin-top:28px">
                    <h2 style="margin:0 0 24px 0; text-align:center">Create Account</h2>
                    <div class="form-group">
                        <label>Username <span style="color:var(--danger)">*</span></label>
                        <input type="text" id="reg-username" placeholder="unique_handle" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Display Name</label>
                        <input type="text" id="reg-displayname" placeholder="Your Name (optional)">
                    </div>
                    <div class="form-group">
                        <label>Password <span style="color:var(--danger)">*</span></label>
                        <input type="password" id="reg-password" placeholder="••••••••">
                    </div>
                    <button class="btn btn-primary btn-block" onclick="registerAndJoin()">
                        Create & Enter Room <i class="fa-solid fa-arrow-right"></i>
                    </button>
                </div>

                <div id="connection-error" class="error-msg"></div>
            </div>

            <!-- ── Active Chat Panel ─────────────────────────────────── -->
            <div id="chat-panel" class="panel" style="display:none;">
                <div class="chat-header">
                    <div>
                        <span class="status-dot"></span>
                        <h3 id="room-title">Room: general</h3>
                    </div>
                    <button class="btn btn-secondary btn-sm" onclick="disconnectWebSocket()">
                        <i class="fa-solid fa-right-from-bracket"></i> Leave
                    </button>
                </div>

                <div class="chat-box" id="messages"></div>

                <div class="input-area">
                    <input type="text" id="message-input" placeholder="Type a message..."
                           onkeypress="handleKeyPress(event)">
                    <button class="btn btn-primary btn-icon" onclick="sendMessage()">
                        <i class="fa-solid fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</main>

<script src="chat.js"></script>
</body>
</html>
